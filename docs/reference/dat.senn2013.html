<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Studies on the Effectiveness of Glucose-Lowering Agents — dat.senn2013 • metafor</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Studies on the Effectiveness of Glucose-Lowering Agents — dat.senn2013" />
<meta property="og:description" content="Results from 26 trials examining the effectiveness of glucose-lowering agents in patients with type 2 diabetes" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.5-52</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/index.php/jss/article/view/v036i03/v36i03.pdf">JSS Article (pdf)</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/wviechtb">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Studies on the Effectiveness of Glucose-Lowering Agents</h1>
    
    <div class="hidden name"><code>dat.senn2013.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Results from 26 trials examining the effectiveness of glucose-lowering agents in patients with type 2 diabetes</p>
    </div>

    <pre class="usage"><span class='va'>dat.senn2013</span></pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>The data frame contains the following columns:</p><table class='table'>
<tr><td><b>study</b></td><td><code>character</code></td><td>(first) author and year of study</td></tr>
<tr><td><b>ni</b></td><td><code>numeric</code></td><td>sample size of the study arm</td></tr>
<tr><td><b>treatment</b></td><td><code>character</code></td><td>treatment given</td></tr>
<tr><td><b>comment</b></td><td><code>character</code></td><td>whether figures given are based on raw values at outcome or on change from baseline</td></tr>
<tr><td><b>mi</b></td><td><code>numeric</code></td><td>mean score</td></tr>
<tr><td><b>sdi</b></td><td><code>numeric</code></td><td>standard deviation</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The dataset includes the results from 26 randomized controlled trials examining the effectiveness of adding various oral glucose-lowering agents to a baseline sulfonylurea therapy in patients with type 2 diabetes. The outcome measured in the studies was either the mean HbA1c level at follow-up or the mean change in HbA1c level from baseline to follow-up. A total of 10 different treatment types were examined in these studies: acarbose, benfluorex, metformin, miglitol, pioglitazone, placebo, rosiglitazone, sitagliptin, sulfonylurea alone, and vildagliptin. One study included three treatment arms (Willms, 1999), while the rest of the studies included two treatment arms (hence, the dataset includes the results from 53 treatment arms).</p>
<p>The data can be used for a network meta-analysis, either using an arm-based or a contrast-based model. See &#8216;Examples&#8217; below.</p>
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Law, M., Jackson, D., Turner, R., Rhodes, K., &amp; Viechtbauer, W. (2016). Two new methods to fit models for network meta-analysis with random inconsistency effects. <em>BMC Medical Research Methodology</em>, <b>16</b>, 87. <a href='https://doi.org/10.1186/s12874-016-0184-5'>https://doi.org/10.1186/s12874-016-0184-5</a></p>
<p>Senn, S., Gavini, F., Magrez, D., &amp; Scheen, A. (2013). Issues in performing a network meta-analysis. <em>Statistical Methods in Medical Research</em>, <b>22</b>(2), 169--189. <a href='https://doi.org/10.1177/0962280211432220'>https://doi.org/10.1177/0962280211432220</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### copy data into 'dat' and examine data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.senn2013</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;                    study  ni     treatment comment    mi   sdi
#&gt; 1       De Fronzo (1995) 213     metformin  change -1.70 1.459
#&gt; 2       De Fronzo (1995) 209       placebo  change  0.20 1.446
#&gt; 3           Lewin (2007) 431     metformin  change -0.74 1.106
#&gt; 4           Lewin (2007) 144       placebo  change  0.08 1.004
#&gt; 5          Willms (1999)  29     metformin  change -2.50 0.862
#&gt; 6          Willms (1999)  31      acarbose  change -2.30 1.782
#&gt; 7          Willms (1999)  29       placebo  change -1.30 1.831
#&gt; 8        Davidson (2007) 117 rosiglitazone  change -1.20 1.097
#&gt; 9        Davidson (2007) 116       placebo  change  0.14 1.093
#&gt; 10  Wolffenbuttel (1999) 183 rosiglitazone  change -0.90 1.100
#&gt; 11  Wolffenbuttel (1999) 192       placebo  change  0.20 1.110
#&gt; 12         Kipnes (2001) 182  pioglitazone  change -1.20 1.369
#&gt; 13         Kipnes (2001) 181       placebo  change  0.10 1.024
#&gt; 14        Kerenyi (2004) 160 rosiglitazone  change -0.91 0.990
#&gt; 15        Kerenyi (2004) 154       placebo  change -0.14 0.920
#&gt; 16       Hanefeld (2004) 319  pioglitazone     raw  7.61 1.072
#&gt; 17       Hanefeld (2004) 320     metformin     raw  7.45 1.073
#&gt; 18         Derosa (2004)  45  pioglitazone     raw  6.80 0.800
#&gt; 19         Derosa (2004)  42 rosiglitazone     raw  6.70 0.900
#&gt; 20          Baksi (2004) 218 rosiglitazone  change -1.20 1.112
#&gt; 21          Baksi (2004) 233       placebo  change  0.10 1.036
#&gt; 22     Rosenstock (2008)  59 rosiglitazone  change -1.17 1.229
#&gt; 23     Rosenstock (2008)  57       placebo  change -0.08 1.208
#&gt; 24            Zhu (2003) 210 rosiglitazone  change -1.90 1.470
#&gt; 25            Zhu (2003) 105       placebo  change -0.40 1.300
#&gt; 26           Yang (2003) 102 rosiglitazone  change -1.09 1.650
#&gt; 27           Yang (2003)  96     metformin  change -0.95 1.500
#&gt; 28 Vongthavaravat (2002) 164 rosiglitazone  change -1.10 1.559
#&gt; 29 Vongthavaravat (2002) 170  sulfonylurea  change  0.10 0.992
#&gt; 30          Oyama (2008)  41      acarbose  change -0.70 0.800
#&gt; 31          Oyama (2008)  43  sulfonylurea  change -0.30 0.600
#&gt; 32          Costa (1997)  36      acarbose  change -1.10 0.360
#&gt; 33          Costa (1997)  29       placebo  change -0.30 0.700
#&gt; 34      Hermansen (2007) 106   sitagliptin  change -0.30 0.940
#&gt; 35      Hermansen (2007) 106       placebo  change  0.27 0.940
#&gt; 36         Garber (2008) 132  vildagliptin  change -0.63 1.034
#&gt; 37         Garber (2008) 144       placebo  change  0.07 1.080
#&gt; 38           Alex (1998) 291     metformin  change  0.13 1.428
#&gt; 39           Alex (1998) 300  sulfonylurea  change  0.50 1.450
#&gt; 40       Johnston (1994)  68      miglitol  change -0.41 1.072
#&gt; 41       Johnston (1994)  63       placebo  change  0.33 1.032
#&gt; 42      Johnston (1998a)  91      miglitol  change -0.43 0.954
#&gt; 43      Johnston (1998a)  43       placebo  change  0.98 1.311
#&gt; 44            Kim (2007)  57 rosiglitazone  change -1.10 1.341
#&gt; 45            Kim (2007)  56     metformin  change -1.10 1.139
#&gt; 46      Johnston (1998b)  49      miglitol  change -0.12 1.400
#&gt; 47      Johnston (1998b)  34       placebo  change  0.56 1.166
#&gt; 48 Gonzalez-Ortiz (2004)  34     metformin  change -1.30 1.861
#&gt; 49 Gonzalez-Ortiz (2004)  37       placebo  change -0.90 1.803
#&gt; 50         Stucci (1996)  28    benfluorex     raw  8.03 1.290
#&gt; 51         Stucci (1996)  30       placebo     raw  8.26 1.350
#&gt; 52         Moulin (2006) 161    benfluorex  change -0.82 1.028
#&gt; 53         Moulin (2006) 156       placebo  change  0.19 1.374</div><div class='input'>
<span class='co'>### create network graph ('plyr' and 'igraph' packages must be installed)</span>
<span class='co'># \dontrun{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://igraph.org'>igraph</a></span><span class='op'>)</span>
<span class='va'>pairs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>,
   <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/combn.html'>combn</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, stringsAsFactors<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>pairs</span><span class='op'>$</span><span class='va'>X1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>pairs</span><span class='op'>$</span><span class='va'>X1</span>, levels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>pairs</span><span class='op'>$</span><span class='va'>X2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>pairs</span><span class='op'>$</span><span class='va'>X2</span>, levels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>pairs</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>pairs</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>tab</span> <span class='co'># adjacency matrix</span>
</div><div class='output co'>#&gt;                
#&gt;                 acarbose benfluorex metformin miglitol pioglitazone placebo
#&gt;   acarbose             0          0         0        0            0       2
#&gt;   benfluorex           0          0         0        0            0       2
#&gt;   metformin            1          0         0        0            0       4
#&gt;   miglitol             0          0         0        0            0       3
#&gt;   pioglitazone         0          0         1        0            0       1
#&gt;   placebo              0          0         0        0            0       0
#&gt;   rosiglitazone        0          0         2        0            0       6
#&gt;   sitagliptin          0          0         0        0            0       1
#&gt;   sulfonylurea         0          0         0        0            0       0
#&gt;   vildagliptin         0          0         0        0            0       1
#&gt;                
#&gt;                 rosiglitazone sitagliptin sulfonylurea vildagliptin
#&gt;   acarbose                  0           0            1            0
#&gt;   benfluorex                0           0            0            0
#&gt;   metformin                 0           0            1            0
#&gt;   miglitol                  0           0            0            0
#&gt;   pioglitazone              1           0            0            0
#&gt;   placebo                   0           0            0            0
#&gt;   rosiglitazone             0           0            1            0
#&gt;   sitagliptin               0           0            0            0
#&gt;   sulfonylurea              0           0            0            0
#&gt;   vildagliptin              0           0            0            0</div><div class='input'><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html'>graph_from_adjacency_matrix</a></span><span class='op'>(</span><span class='va'>tab</span>, mode <span class='op'>=</span> <span class='st'>"plus"</span>, weighted<span class='op'>=</span><span class='cn'>TRUE</span>, diag<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g</span>, edge.curved<span class='op'>=</span><span class='cn'>FALSE</span>, edge.width<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>, layout<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/layout_as_star.html'>layout_as_star</a></span><span class='op'>(</span><span class='va'>g</span>, center<span class='op'>=</span><span class='st'>"placebo"</span><span class='op'>)</span>,
     vertex.size<span class='op'>=</span><span class='fl'>45</span>, vertex.color<span class='op'>=</span><span class='st'>"lightgray"</span>, vertex.label.color<span class='op'>=</span><span class='st'>"black"</span>, vertex.label.font<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='co'># }</span>
</div><div class='img'><img src='dat.senn2013-1.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'>### table of studies versus treatments examined</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/addmargins.html'>addmargins</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span>, zero.print<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                        
#&gt;                         acarbose benfluorex metformin miglitol pioglitazone
#&gt;   Alex (1998)                                       1                      
#&gt;   Baksi (2004)                                                             
#&gt;   Costa (1997)                 1                                           
#&gt;   Davidson (2007)                                                          
#&gt;   De Fronzo (1995)                                  1                      
#&gt;   Derosa (2004)                                                           1
#&gt;   Garber (2008)                                                            
#&gt;   Gonzalez-Ortiz (2004)                             1                      
#&gt;   Hanefeld (2004)                                   1                     1
#&gt;   Hermansen (2007)                                                         
#&gt;   Johnston (1994)                                            1             
#&gt;   Johnston (1998a)                                           1             
#&gt;   Johnston (1998b)                                           1             
#&gt;   Kerenyi (2004)                                                           
#&gt;   Kim (2007)                                        1                      
#&gt;   Kipnes (2001)                                                           1
#&gt;   Lewin (2007)                                      1                      
#&gt;   Moulin (2006)                           1                                
#&gt;   Oyama (2008)                 1                                           
#&gt;   Rosenstock (2008)                                                        
#&gt;   Stucci (1996)                           1                                
#&gt;   Vongthavaravat (2002)                                                    
#&gt;   Willms (1999)                1                    1                      
#&gt;   Wolffenbuttel (1999)                                                     
#&gt;   Yang (2003)                                       1                      
#&gt;   Zhu (2003)                                                               
#&gt;   Sum                          3          2         8        3            3
#&gt;                        
#&gt;                         placebo rosiglitazone sitagliptin sulfonylurea
#&gt;   Alex (1998)                                                        1
#&gt;   Baksi (2004)                1             1                         
#&gt;   Costa (1997)                1                                       
#&gt;   Davidson (2007)             1             1                         
#&gt;   De Fronzo (1995)            1                                       
#&gt;   Derosa (2004)                             1                         
#&gt;   Garber (2008)               1                                       
#&gt;   Gonzalez-Ortiz (2004)       1                                       
#&gt;   Hanefeld (2004)                                                     
#&gt;   Hermansen (2007)            1                         1             
#&gt;   Johnston (1994)             1                                       
#&gt;   Johnston (1998a)            1                                       
#&gt;   Johnston (1998b)            1                                       
#&gt;   Kerenyi (2004)              1             1                         
#&gt;   Kim (2007)                                1                         
#&gt;   Kipnes (2001)               1                                       
#&gt;   Lewin (2007)                1                                       
#&gt;   Moulin (2006)               1                                       
#&gt;   Oyama (2008)                                                       1
#&gt;   Rosenstock (2008)           1             1                         
#&gt;   Stucci (1996)               1                                       
#&gt;   Vongthavaravat (2002)                     1                        1
#&gt;   Willms (1999)               1                                       
#&gt;   Wolffenbuttel (1999)        1             1                         
#&gt;   Yang (2003)                               1                         
#&gt;   Zhu (2003)                  1             1                         
#&gt;   Sum                        19            10           1            3
#&gt;                        
#&gt;                         vildagliptin Sum
#&gt;   Alex (1998)                          2
#&gt;   Baksi (2004)                         2
#&gt;   Costa (1997)                         2
#&gt;   Davidson (2007)                      2
#&gt;   De Fronzo (1995)                     2
#&gt;   Derosa (2004)                        2
#&gt;   Garber (2008)                    1   2
#&gt;   Gonzalez-Ortiz (2004)                2
#&gt;   Hanefeld (2004)                      2
#&gt;   Hermansen (2007)                     2
#&gt;   Johnston (1994)                      2
#&gt;   Johnston (1998a)                     2
#&gt;   Johnston (1998b)                     2
#&gt;   Kerenyi (2004)                       2
#&gt;   Kim (2007)                           2
#&gt;   Kipnes (2001)                        2
#&gt;   Lewin (2007)                         2
#&gt;   Moulin (2006)                        2
#&gt;   Oyama (2008)                         2
#&gt;   Rosenstock (2008)                    2
#&gt;   Stucci (1996)                        2
#&gt;   Vongthavaravat (2002)                2
#&gt;   Willms (1999)                        3
#&gt;   Wolffenbuttel (1999)                 2
#&gt;   Yang (2003)                          2
#&gt;   Zhu (2003)                           2
#&gt;   Sum                              1  53</div><div class='input'>
<span class='co'>### table of frequencies with which treatment pairs were studied</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>as.table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>crossprod</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, zero.print<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                
#&gt;                 acarbose benfluorex metformin miglitol pioglitazone placebo
#&gt;   acarbose             3                    1                             2
#&gt;   benfluorex                      2                                       2
#&gt;   metformin            1                    8                     1       4
#&gt;   miglitol                                           3                    3
#&gt;   pioglitazone                              1                     3       1
#&gt;   placebo              2          2         4        3            1      19
#&gt;   rosiglitazone                             2                     1       6
#&gt;   sitagliptin                                                             1
#&gt;   sulfonylurea         1                    1                              
#&gt;   vildagliptin                                                            1
#&gt;                
#&gt;                 rosiglitazone sitagliptin sulfonylurea vildagliptin
#&gt;   acarbose                                           1             
#&gt;   benfluorex                                                       
#&gt;   metformin                 2                        1             
#&gt;   miglitol                                                         
#&gt;   pioglitazone              1                                      
#&gt;   placebo                   6           1                         1
#&gt;   rosiglitazone            10                        1             
#&gt;   sitagliptin                           1                          
#&gt;   sulfonylurea              1                        3             
#&gt;   vildagliptin                                                    1</div><div class='input'>
<span class='co'>### add means and sampling variances of the means to the dataset</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"MN"</span>, mi<span class='op'>=</span><span class='va'>mi</span>, sdi<span class='op'>=</span><span class='va'>sdi</span>, ni<span class='op'>=</span><span class='va'>ni</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>)</span>

<span class='co'>### turn treatment variable into factor and set reference level</span>
<span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/relevel.html'>relevel</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span>, ref<span class='op'>=</span><span class='st'>"placebo"</span><span class='op'>)</span>

<span class='co'>### add a space before each level (this makes the output a bit more legible)</span>
<span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>" "</span>, <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### network meta-analysis using an arm-based fixed-effects model with fixed study effects</span>
<span class='va'>res.fe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>study</span> <span class='op'>+</span> <span class='va'>treatment</span> <span class='op'>-</span> <span class='fl'>1</span>, data<span class='op'>=</span><span class='va'>dat</span>, slab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>study</span>, <span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>res.fe</span>
</div><div class='output co'>#&gt; 
#&gt; Multivariate Meta-Analysis Model (k = 53; method: REML)
#&gt; 
#&gt; Variance Components: none
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 18) = 96.9841, p-val &lt; .0001
#&gt; 
#&gt; Test of Moderators (coefficients 1:35):
#&gt; QM(df = 35) = 42156.8401, p-val &lt; .0001
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;                             estimate      se      zval    pval    ci.lb 
#&gt; studyAlex (1998)              1.0917  0.0866   12.6029  &lt;.0001   0.9219 
#&gt; studyBaksi (2004)             0.0560  0.0548    1.0230  0.3063  -0.0513 
#&gt; studyCosta (1997)            -0.2775  0.1047   -2.6496  0.0081  -0.4827 
#&gt; studyDavidson (2007)          0.0709  0.0756    0.9377  0.3484  -0.0773 
#&gt; studyDe Fronzo (1995)        -0.1932  0.0767   -2.5176  0.0118  -0.3436 
#&gt; studyDerosa (2004)            7.8814  0.1041   75.7432  &lt;.0001   7.6774 
#&gt; studyGarber (2008)            0.0700  0.0900    0.7778  0.4367  -0.1064 
#&gt; studyGonzalez-Ortiz (2004)   -0.5693  0.2189   -2.6004  0.0093  -0.9984 
#&gt; studyHanefeld (2004)          8.6201  0.0724  119.1426  &lt;.0001   8.4783 
#&gt; studyHermansen (2007)         0.2700  0.0913    2.9573  0.0031   0.0911 
#&gt; studyJohnston (1994)          0.4319  0.1117    3.8667  0.0001   0.2130 
#&gt; studyJohnston (1998a)         0.6071  0.1353    4.4877  &lt;.0001   0.3420 
#&gt; studyJohnston (1998b)         0.6919  0.1550    4.4642  &lt;.0001   0.3881 
#&gt; studyKerenyi (2004)           0.0642  0.0584    1.1008  0.2710  -0.0501 
#&gt; studyKim (2007)               0.0512  0.1235    0.4147  0.6783  -0.1908 
#&gt; studyKipnes (2001)            0.0158  0.0667    0.2375  0.8123  -0.1149 
#&gt; studyLewin (2007)             0.2892  0.0618    4.6804  &lt;.0001   0.1681 
#&gt; studyMoulin (2006)            0.1220  0.1051    1.1609  0.2457  -0.0840 
#&gt; studyOyama (2008)             0.1352  0.1100    1.2290  0.2191  -0.0804 
#&gt; studyRosenstock (2008)       -0.0241  0.1156   -0.2082  0.8351  -0.2507 
#&gt; studyStucci (1996)            8.6013  0.1849   46.5307  &lt;.0001   8.2390 
#&gt; studyVongthavaravat (2002)    0.4165  0.0954    4.3644  &lt;.0001   0.2295 
#&gt; studyWillms (1999)           -1.3878  0.1402   -9.9014  &lt;.0001  -1.6625 
#&gt; studyWolffenbuttel (1999)     0.2502  0.0617    4.0542  &lt;.0001   0.1292 
#&gt; studyYang (2003)              0.1396  0.1196    1.1680  0.2428  -0.0947 
#&gt; studyZhu (2003)              -0.5819  0.0844   -6.8947  &lt;.0001  -0.7473 
#&gt; treatment acarbose           -0.8273  0.1085   -7.6252  &lt;.0001  -1.0400 
#&gt; treatment benfluorex         -0.9051  0.1271   -7.1211  &lt;.0001  -1.1543 
#&gt; treatment metformin          -1.1140  0.0596  -18.6892  &lt;.0001  -1.2309 
#&gt; treatment miglitol           -0.9438  0.1269   -7.4375  &lt;.0001  -1.1926 
#&gt; treatment pioglitazone       -1.0663  0.0758  -14.0590  &lt;.0001  -1.2149 
#&gt; treatment rosiglitazone      -1.2019  0.0477  -25.2158  &lt;.0001  -1.2953 
#&gt; treatment sitagliptin        -0.5700  0.1291   -4.4145  &lt;.0001  -0.8231 
#&gt; treatment sulfonylurea       -0.4394  0.0915   -4.8041  &lt;.0001  -0.6187 
#&gt; treatment vildagliptin       -0.7000  0.1273   -5.4998  &lt;.0001  -0.9495 
#&gt;                               ci.ub 
#&gt; studyAlex (1998)             1.2615  *** 
#&gt; studyBaksi (2004)            0.1633      
#&gt; studyCosta (1997)           -0.0722   ** 
#&gt; studyDavidson (2007)         0.2191      
#&gt; studyDe Fronzo (1995)       -0.0428    * 
#&gt; studyDerosa (2004)           8.0853  *** 
#&gt; studyGarber (2008)           0.2464      
#&gt; studyGonzalez-Ortiz (2004)  -0.1402   ** 
#&gt; studyHanefeld (2004)         8.7619  *** 
#&gt; studyHermansen (2007)        0.4489   ** 
#&gt; studyJohnston (1994)         0.6509  *** 
#&gt; studyJohnston (1998a)        0.8723  *** 
#&gt; studyJohnston (1998b)        0.9957  *** 
#&gt; studyKerenyi (2004)          0.1786      
#&gt; studyKim (2007)              0.2933      
#&gt; studyKipnes (2001)           0.1466      
#&gt; studyLewin (2007)            0.4103  *** 
#&gt; studyMoulin (2006)           0.3280      
#&gt; studyOyama (2008)            0.3508      
#&gt; studyRosenstock (2008)       0.2025      
#&gt; studyStucci (1996)           8.9636  *** 
#&gt; studyVongthavaravat (2002)   0.6035  *** 
#&gt; studyWillms (1999)          -1.1131  *** 
#&gt; studyWolffenbuttel (1999)    0.3711  *** 
#&gt; studyYang (2003)             0.3740      
#&gt; studyZhu (2003)             -0.4165  *** 
#&gt; treatment acarbose          -0.6147  *** 
#&gt; treatment benfluorex        -0.6560  *** 
#&gt; treatment metformin         -0.9972  *** 
#&gt; treatment miglitol          -0.6951  *** 
#&gt; treatment pioglitazone      -0.9176  *** 
#&gt; treatment rosiglitazone     -1.1084  *** 
#&gt; treatment sitagliptin       -0.3169  *** 
#&gt; treatment sulfonylurea      -0.2601  *** 
#&gt; treatment vildagliptin      -0.4505  *** 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'>### test if treatment factor as a whole is significant</span>
<span class='fu'><a href='anova.rma.html'>anova</a></span><span class='op'>(</span><span class='va'>res.fe</span>, btt<span class='op'>=</span><span class='st'>"treatment"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Test of Moderators (coefficients 27:35):
#&gt; QM(df = 9) = 1060.3371, p-val &lt; .0001
#&gt; </div><div class='input'>
<span class='co'>### forest plot of the contrast estimates (treatments versus placebos)</span>
<span class='fu'><a href='forest.html'>forest</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fu'><a href='coef.rma.html'>coef</a></span><span class='op'>(</span><span class='va'>res.fe</span><span class='op'>)</span>, <span class='fl'>9</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='vcov.rma.html'>vcov</a></span><span class='op'>(</span><span class='va'>res.fe</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>9</span><span class='op'>)</span>, slab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
       xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.0</span><span class='op'>)</span>, alim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>, psize<span class='op'>=</span><span class='fl'>1</span>, xlab<span class='op'>=</span><span class='st'>"Estimate"</span>, header<span class='op'>=</span><span class='st'>"Treatment"</span><span class='op'>)</span>
</div><div class='img'><img src='dat.senn2013-2.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'>### weight matrix for the estimation of the fixed effects (leaving out study effects)</span>
<span class='va'>w</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fu'><a href='vcov.rma.html'>vcov</a></span><span class='op'>(</span><span class='va'>res.fe</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='model.matrix.rma.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>res.fe</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='fu'><a href='weights.rma.uni.html'>weights</a></span><span class='op'>(</span><span class='va'>res.fe</span>, type<span class='op'>=</span><span class='st'>"matrix"</span><span class='op'>)</span>, <span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>w</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>res.fe</span><span class='op'>$</span><span class='va'>slab</span>

<span class='co'>### create shade plot for the diabetes network with placebo as the reference treatment</span>
<span class='co'>### negative values in blue shades, positive values in red shades</span>
<span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"gray95"</span>, <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>9</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/heatmap.html'>heatmap</a></span><span class='op'>(</span><span class='va'>w</span>, Rowv<span class='op'>=</span><span class='cn'>NA</span>, Colv<span class='op'>=</span><span class='cn'>NA</span>, scale<span class='op'>=</span><span class='st'>"none"</span>, margins<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>11</span><span class='op'>)</span>, col<span class='op'>=</span><span class='va'>cols</span>,
        cexRow<span class='op'>=</span><span class='fl'>.7</span>, cexCol<span class='op'>=</span><span class='fl'>1</span>, labCol<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='img'><img src='dat.senn2013-3.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'>### network meta-analysis using an arm-based random-effects model with fixed study effects</span>
<span class='co'>### by setting rho=1/2, tau^2 reflects the amount of heterogeneity for all treatment comparisons</span>
<span class='va'>res.re</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>vi</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>study</span> <span class='op'>+</span> <span class='va'>treatment</span> <span class='op'>-</span> <span class='fl'>1</span>, random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>treatment</span> <span class='op'>|</span> <span class='va'>study</span>, rho<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>,
                 data<span class='op'>=</span><span class='va'>dat</span>, slab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>study</span>, <span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>res.re</span>
</div><div class='output co'>#&gt; 
#&gt; Multivariate Meta-Analysis Model (k = 53; method: REML)
#&gt; 
#&gt; Variance Components:
#&gt; 
#&gt; outer factor: study     (nlvls = 26)
#&gt; inner factor: treatment (nlvls = 10)
#&gt; 
#&gt;             estim    sqrt  fixed 
#&gt; tau^2      0.0999  0.3161     no 
#&gt; rho        0.5000            yes 
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 18) = 96.9841, p-val &lt; .0001
#&gt; 
#&gt; Test of Moderators (coefficients 1:35):
#&gt; QM(df = 35) = 2237.5843, p-val &lt; .0001
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;                             estimate      se     zval    pval    ci.lb    ci.ub 
#&gt; studyAlex (1998)              1.0880  0.3221   3.3777  0.0007   0.4567   1.7193 
#&gt; studyBaksi (2004)             0.0672  0.2850   0.2357  0.8136  -0.4915   0.6258 
#&gt; studyCosta (1997)            -0.2770  0.3118  -0.8885  0.3743  -0.8881   0.3341 
#&gt; studyDavidson (2007)          0.0869  0.2896   0.2999  0.7643  -0.4808   0.6546 
#&gt; studyDe Fronzo (1995)        -0.1858  0.2924  -0.6355  0.5251  -0.7590   0.3873 
#&gt; studyDerosa (2004)            7.9315  0.3197  24.8072  &lt;.0001   7.3048   8.5581 
#&gt; studyGarber (2008)            0.0700  0.3287   0.2130  0.8313  -0.5742   0.7142 
#&gt; studyGonzalez-Ortiz (2004)   -0.5534  0.3567  -1.5514  0.1208  -1.2526   0.1458 
#&gt; studyHanefeld (2004)          8.6589  0.3139  27.5871  &lt;.0001   8.0437   9.2741 
#&gt; studyHermansen (2007)         0.2700  0.3290   0.8206  0.4119  -0.3749   0.9149 
#&gt; studyJohnston (1994)          0.4349  0.3100   1.4033  0.1605  -0.1726   1.0424 
#&gt; studyJohnston (1998a)         0.7039  0.3228   2.1808  0.0292   0.0713   1.3366 
#&gt; studyJohnston (1998b)         0.6949  0.3280   2.1184  0.0341   0.0520   1.3379 
#&gt; studyKerenyi (2004)           0.0906  0.2857   0.3170  0.7512  -0.4693   0.6505 
#&gt; studyKim (2007)               0.0782  0.3180   0.2460  0.8057  -0.5450   0.7014 
#&gt; studyKipnes (2001)            0.0180  0.2988   0.0603  0.9519  -0.5676   0.6037 
#&gt; studyLewin (2007)             0.2400  0.2887   0.8314  0.4058  -0.3259   0.8060 
#&gt; studyMoulin (2006)            0.0471  0.3172   0.1484  0.8820  -0.5747   0.6689 
#&gt; studyOyama (2008)             0.1287  0.3461   0.3720  0.7099  -0.5496   0.8071 
#&gt; studyRosenstock (2008)       -0.0081  0.3026  -0.0269  0.9786  -0.6012   0.5849 
#&gt; studyStucci (1996)            8.5150  0.3528  24.1346  &lt;.0001   7.8235   9.2065 
#&gt; studyVongthavaravat (2002)    0.3400  0.3210   1.0594  0.2894  -0.2890   0.9691 
#&gt; studyWillms (1999)           -1.3770  0.3168  -4.3471  &lt;.0001  -1.9978  -0.7561 
#&gt; studyWolffenbuttel (1999)     0.2668  0.2863   0.9316  0.3515  -0.2945   0.8280 
#&gt; studyYang (2003)              0.1614  0.3161   0.5108  0.6095  -0.4581   0.7810 
#&gt; studyZhu (2003)              -0.5392  0.2926  -1.8427  0.0654  -1.1128   0.0343 
#&gt; treatment acarbose           -0.8414  0.2384  -3.5288  0.0004  -1.3087  -0.3741 
#&gt; treatment benfluorex         -0.7369  0.2776  -2.6545  0.0079  -1.2810  -0.1928 
#&gt; treatment metformin          -1.1284  0.1494  -7.5528  &lt;.0001  -1.4212  -0.8356 
#&gt; treatment miglitol           -0.9499  0.2253  -4.2170  &lt;.0001  -1.3914  -0.5084 
#&gt; treatment pioglitazone       -1.1294  0.2119  -5.3295  &lt;.0001  -1.5448  -0.7141 
#&gt; treatment rosiglitazone      -1.2337  0.1235  -9.9933  &lt;.0001  -1.4757  -0.9918 
#&gt; treatment sitagliptin        -0.5700  0.3414  -1.6694  0.0950  -1.2392   0.0992 
#&gt; treatment sulfonylurea       -0.4175  0.2326  -1.7950  0.0727  -0.8734   0.0384 
#&gt; treatment vildagliptin       -0.7000  0.3408  -2.0543  0.0400  -1.3679  -0.0321 
#&gt;  
#&gt; studyAlex (1998)            *** 
#&gt; studyBaksi (2004) 
#&gt; studyCosta (1997) 
#&gt; studyDavidson (2007) 
#&gt; studyDe Fronzo (1995) 
#&gt; studyDerosa (2004)          *** 
#&gt; studyGarber (2008) 
#&gt; studyGonzalez-Ortiz (2004) 
#&gt; studyHanefeld (2004)        *** 
#&gt; studyHermansen (2007) 
#&gt; studyJohnston (1994) 
#&gt; studyJohnston (1998a)         * 
#&gt; studyJohnston (1998b)         * 
#&gt; studyKerenyi (2004) 
#&gt; studyKim (2007) 
#&gt; studyKipnes (2001) 
#&gt; studyLewin (2007) 
#&gt; studyMoulin (2006) 
#&gt; studyOyama (2008) 
#&gt; studyRosenstock (2008) 
#&gt; studyStucci (1996)          *** 
#&gt; studyVongthavaravat (2002) 
#&gt; studyWillms (1999)          *** 
#&gt; studyWolffenbuttel (1999) 
#&gt; studyYang (2003) 
#&gt; studyZhu (2003)               . 
#&gt; treatment acarbose          *** 
#&gt; treatment benfluorex         ** 
#&gt; treatment metformin         *** 
#&gt; treatment miglitol          *** 
#&gt; treatment pioglitazone      *** 
#&gt; treatment rosiglitazone     *** 
#&gt; treatment sitagliptin         . 
#&gt; treatment sulfonylurea        . 
#&gt; treatment vildagliptin        * 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'>### test if treatment factor as a whole is significant</span>
<span class='fu'><a href='anova.rma.html'>anova</a></span><span class='op'>(</span><span class='va'>res.re</span>, btt<span class='op'>=</span><span class='st'>"treatment"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Test of Moderators (coefficients 27:35):
#&gt; QM(df = 9) = 167.9616, p-val &lt; .0001
#&gt; </div><div class='input'>
<span class='co'>### forest plot of the contrast estimates (treatments versus placebos)</span>
<span class='fu'><a href='forest.html'>forest</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fu'><a href='coef.rma.html'>coef</a></span><span class='op'>(</span><span class='va'>res.re</span><span class='op'>)</span>, <span class='fl'>9</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='vcov.rma.html'>vcov</a></span><span class='op'>(</span><span class='va'>res.re</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>9</span><span class='op'>)</span>, slab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>treatment</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
       xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3.0</span>, <span class='fl'>2.5</span><span class='op'>)</span>, alim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>, psize<span class='op'>=</span><span class='fl'>1</span>, xlab<span class='op'>=</span><span class='st'>"Estimate"</span>, header<span class='op'>=</span><span class='st'>"Treatment"</span><span class='op'>)</span>
</div><div class='img'><img src='dat.senn2013-4.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'>### compute contribution of each study to the overall Q-test value</span>
<span class='va'>qi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/by.html'>by</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>resid</a></span><span class='op'>(</span><span class='va'>res.fe</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>vi</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span>, <span class='va'>sum</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### check that the values add up</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>qi</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 96.98407</div><div class='input'><span class='va'>res.fe</span><span class='op'>$</span><span class='va'>QE</span>
</div><div class='output co'>#&gt; [1] 96.98407</div><div class='input'>
<span class='co'>### plot the values</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>qi</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>qi</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>s</span>, pch<span class='op'>=</span><span class='fl'>19</span>, xaxt<span class='op'>=</span><span class='st'>"n"</span>, yaxt<span class='op'>=</span><span class='st'>"n"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>40</span><span class='op'>)</span>, xlab<span class='op'>=</span><span class='st'>"Chi-Square Contribution"</span>, ylab<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span>side<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span>side<span class='op'>=</span><span class='fl'>2</span>, at<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>s</span>, labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>qi</span><span class='op'>)</span>, las<span class='op'>=</span><span class='fl'>1</span>, tcl<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/segments.html'>segments</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='va'>s</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>s</span>, <span class='va'>qi</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>s</span><span class='op'>)</span>
</div><div class='img'><img src='dat.senn2013-5.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'>############################################################################</span>

<span class='co'>### restructure dataset to a contrast-based format</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.senn2013</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>:</span><span class='fl'>2</span>,<span class='fl'>5</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span><span class='op'>]</span> <span class='co'># reorder variables first</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='to.wide.html'>to.wide</a></span><span class='op'>(</span><span class='va'>dat</span>, study<span class='op'>=</span><span class='st'>"study"</span>, grp<span class='op'>=</span><span class='st'>"treatment"</span>, ref<span class='op'>=</span><span class='st'>"placebo"</span>, grpvars<span class='op'>=</span><span class='fl'>4</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;                    study comment   treatment.1 ni.1  mi.1 sdi.1   treatment.2
#&gt; 1            Alex (1998)  change     metformin  291  0.13 1.428  sulfonylurea
#&gt; 2           Baksi (2004)  change rosiglitazone  218 -1.20 1.112       placebo
#&gt; 3           Costa (1997)  change      acarbose   36 -1.10 0.360       placebo
#&gt; 4        Davidson (2007)  change rosiglitazone  117 -1.20 1.097       placebo
#&gt; 5       De Fronzo (1995)  change     metformin  213 -1.70 1.459       placebo
#&gt; 6          Derosa (2004)     raw  pioglitazone   45  6.80 0.800 rosiglitazone
#&gt; 7          Garber (2008)  change  vildagliptin  132 -0.63 1.034       placebo
#&gt; 8  Gonzalez-Ortiz (2004)  change     metformin   34 -1.30 1.861       placebo
#&gt; 9        Hanefeld (2004)     raw     metformin  320  7.45 1.073  pioglitazone
#&gt; 10      Hermansen (2007)  change   sitagliptin  106 -0.30 0.940       placebo
#&gt; 11       Johnston (1994)  change      miglitol   68 -0.41 1.072       placebo
#&gt; 12      Johnston (1998a)  change      miglitol   91 -0.43 0.954       placebo
#&gt; 13      Johnston (1998b)  change      miglitol   49 -0.12 1.400       placebo
#&gt; 14        Kerenyi (2004)  change rosiglitazone  160 -0.91 0.990       placebo
#&gt; 15            Kim (2007)  change     metformin   56 -1.10 1.139 rosiglitazone
#&gt; 16         Kipnes (2001)  change  pioglitazone  182 -1.20 1.369       placebo
#&gt; 17          Lewin (2007)  change     metformin  431 -0.74 1.106       placebo
#&gt; 18         Moulin (2006)  change    benfluorex  161 -0.82 1.028       placebo
#&gt; 19          Oyama (2008)  change      acarbose   41 -0.70 0.800  sulfonylurea
#&gt; 20     Rosenstock (2008)  change rosiglitazone   59 -1.17 1.229       placebo
#&gt; 21         Stucci (1996)     raw    benfluorex   28  8.03 1.290       placebo
#&gt; 22 Vongthavaravat (2002)  change rosiglitazone  164 -1.10 1.559  sulfonylurea
#&gt; 23         Willms (1999)  change      acarbose   31 -2.30 1.782       placebo
#&gt; 24         Willms (1999)  change     metformin   29 -2.50 0.862       placebo
#&gt; 25  Wolffenbuttel (1999)  change rosiglitazone  183 -0.90 1.100       placebo
#&gt; 26           Yang (2003)  change     metformin   96 -0.95 1.500 rosiglitazone
#&gt; 27            Zhu (2003)  change rosiglitazone  210 -1.90 1.470       placebo
#&gt;    ni.2  mi.2 sdi.2 id  comp   design
#&gt; 1   300  0.50 1.450  1 me-su    me-su
#&gt; 2   233  0.10 1.036  2 ro-pl    ro-pl
#&gt; 3    29 -0.30 0.700  3 ac-pl    ac-pl
#&gt; 4   116  0.14 1.093  4 ro-pl    ro-pl
#&gt; 5   209  0.20 1.446  5 me-pl    me-pl
#&gt; 6    42  6.70 0.900  6 pi-ro    pi-ro
#&gt; 7   144  0.07 1.080  7 vi-pl    vi-pl
#&gt; 8    37 -0.90 1.803  8 me-pl    me-pl
#&gt; 9   319  7.61 1.072  9 me-pi    me-pi
#&gt; 10  106  0.27 0.940 10 si-pl    si-pl
#&gt; 11   63  0.33 1.032 11 mi-pl    mi-pl
#&gt; 12   43  0.98 1.311 12 mi-pl    mi-pl
#&gt; 13   34  0.56 1.166 13 mi-pl    mi-pl
#&gt; 14  154 -0.14 0.920 14 ro-pl    ro-pl
#&gt; 15   57 -1.10 1.341 15 me-ro    me-ro
#&gt; 16  181  0.10 1.024 16 pi-pl    pi-pl
#&gt; 17  144  0.08 1.004 17 me-pl    me-pl
#&gt; 18  156  0.19 1.374 18 be-pl    be-pl
#&gt; 19   43 -0.30 0.600 19 ac-su    ac-su
#&gt; 20   57 -0.08 1.208 20 ro-pl    ro-pl
#&gt; 21   30  8.26 1.350 21 be-pl    be-pl
#&gt; 22  170  0.10 0.992 22 ro-su    ro-su
#&gt; 23   29 -1.30 1.831 23 ac-pl ac-me-pl
#&gt; 24   29 -1.30 1.831 24 me-pl ac-me-pl
#&gt; 25  192  0.20 1.110 25 ro-pl    ro-pl
#&gt; 26  102 -1.09 1.650 26 me-ro    me-ro
#&gt; 27  105 -0.40 1.300 27 ro-pl    ro-pl</div><div class='input'>
<span class='co'>### calculate mean difference and corresponding sampling variance for each treatment comparison</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"MD"</span>, m1i<span class='op'>=</span><span class='va'>mi.1</span>, sd1i<span class='op'>=</span><span class='va'>sdi.1</span>, n1i<span class='op'>=</span><span class='va'>ni.1</span>,
                            m2i<span class='op'>=</span><span class='va'>mi.2</span>, sd2i<span class='op'>=</span><span class='va'>sdi.2</span>, n2i<span class='op'>=</span><span class='va'>ni.2</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>)</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;                    study comment   treatment.1 ni.1  mi.1 sdi.1   treatment.2 
#&gt; 1            Alex (1998)  change     metformin  291  0.13 1.428  sulfonylurea 
#&gt; 2           Baksi (2004)  change rosiglitazone  218 -1.20 1.112       placebo 
#&gt; 3           Costa (1997)  change      acarbose   36 -1.10 0.360       placebo 
#&gt; 4        Davidson (2007)  change rosiglitazone  117 -1.20 1.097       placebo 
#&gt; 5       De Fronzo (1995)  change     metformin  213 -1.70 1.459       placebo 
#&gt; 6          Derosa (2004)     raw  pioglitazone   45  6.80 0.800 rosiglitazone 
#&gt; 7          Garber (2008)  change  vildagliptin  132 -0.63 1.034       placebo 
#&gt; 8  Gonzalez-Ortiz (2004)  change     metformin   34 -1.30 1.861       placebo 
#&gt; 9        Hanefeld (2004)     raw     metformin  320  7.45 1.073  pioglitazone 
#&gt; 10      Hermansen (2007)  change   sitagliptin  106 -0.30 0.940       placebo 
#&gt; 11       Johnston (1994)  change      miglitol   68 -0.41 1.072       placebo 
#&gt; 12      Johnston (1998a)  change      miglitol   91 -0.43 0.954       placebo 
#&gt; 13      Johnston (1998b)  change      miglitol   49 -0.12 1.400       placebo 
#&gt; 14        Kerenyi (2004)  change rosiglitazone  160 -0.91 0.990       placebo 
#&gt; 15            Kim (2007)  change     metformin   56 -1.10 1.139 rosiglitazone 
#&gt; 16         Kipnes (2001)  change  pioglitazone  182 -1.20 1.369       placebo 
#&gt; 17          Lewin (2007)  change     metformin  431 -0.74 1.106       placebo 
#&gt; 18         Moulin (2006)  change    benfluorex  161 -0.82 1.028       placebo 
#&gt; 19          Oyama (2008)  change      acarbose   41 -0.70 0.800  sulfonylurea 
#&gt; 20     Rosenstock (2008)  change rosiglitazone   59 -1.17 1.229       placebo 
#&gt; 21         Stucci (1996)     raw    benfluorex   28  8.03 1.290       placebo 
#&gt; 22 Vongthavaravat (2002)  change rosiglitazone  164 -1.10 1.559  sulfonylurea 
#&gt; 23         Willms (1999)  change      acarbose   31 -2.30 1.782       placebo 
#&gt; 24         Willms (1999)  change     metformin   29 -2.50 0.862       placebo 
#&gt; 25  Wolffenbuttel (1999)  change rosiglitazone  183 -0.90 1.100       placebo 
#&gt; 26           Yang (2003)  change     metformin   96 -0.95 1.500 rosiglitazone 
#&gt; 27            Zhu (2003)  change rosiglitazone  210 -1.90 1.470       placebo 
#&gt;    ni.2  mi.2 sdi.2 id  comp   design      yi     vi 
#&gt; 1   300  0.50 1.450  1 me-su    me-su -0.3700 0.0140 
#&gt; 2   233  0.10 1.036  2 ro-pl    ro-pl -1.3000 0.0103 
#&gt; 3    29 -0.30 0.700  3 ac-pl    ac-pl -0.8000 0.0205 
#&gt; 4   116  0.14 1.093  4 ro-pl    ro-pl -1.3400 0.0206 
#&gt; 5   209  0.20 1.446  5 me-pl    me-pl -1.9000 0.0200 
#&gt; 6    42  6.70 0.900  6 pi-ro    pi-ro  0.1000 0.0335 
#&gt; 7   144  0.07 1.080  7 vi-pl    vi-pl -0.7000 0.0162 
#&gt; 8    37 -0.90 1.803  8 me-pl    me-pl -0.4000 0.1897 
#&gt; 9   319  7.61 1.072  9 me-pi    me-pi -0.1600 0.0072 
#&gt; 10  106  0.27 0.940 10 si-pl    si-pl -0.5700 0.0167 
#&gt; 11   63  0.33 1.032 11 mi-pl    mi-pl -0.7400 0.0338 
#&gt; 12   43  0.98 1.311 12 mi-pl    mi-pl -1.4100 0.0500 
#&gt; 13   34  0.56 1.166 13 mi-pl    mi-pl -0.6800 0.0800 
#&gt; 14  154 -0.14 0.920 14 ro-pl    ro-pl -0.7700 0.0116 
#&gt; 15   57 -1.10 1.341 15 me-ro    me-ro  0.0000 0.0547 
#&gt; 16  181  0.10 1.024 16 pi-pl    pi-pl -1.3000 0.0161 
#&gt; 17  144  0.08 1.004 17 me-pl    me-pl -0.8200 0.0098 
#&gt; 18  156  0.19 1.374 18 be-pl    be-pl -1.0100 0.0187 
#&gt; 19   43 -0.30 0.600 19 ac-su    ac-su -0.4000 0.0240 
#&gt; 20   57 -0.08 1.208 20 ro-pl    ro-pl -1.0900 0.0512 
#&gt; 21   30  8.26 1.350 21 be-pl    be-pl -0.2300 0.1202 
#&gt; 22  170  0.10 0.992 22 ro-su    ro-su -1.2000 0.0206 
#&gt; 23   29 -1.30 1.831 23 ac-pl ac-me-pl -1.0000 0.2180 
#&gt; 24   29 -1.30 1.831 24 me-pl ac-me-pl -1.2000 0.1412 
#&gt; 25  192  0.20 1.110 25 ro-pl    ro-pl -1.1000 0.0130 
#&gt; 26  102 -1.09 1.650 26 me-ro    me-ro  0.1400 0.0501 
#&gt; 27  105 -0.40 1.300 27 ro-pl    ro-pl -1.5000 0.0264 </div><div class='input'>
<span class='co'>### calculate the variance-covariance matrix of the mean differences for the multitreatment studies</span>
<span class='va'>calc.v</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>sdi.2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>/</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>ni.2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, nrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
   <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>vi</span>
   <span class='va'>v</span>
<span class='op'>}</span>
<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bldiag.html'>bldiag</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span><span class='op'>)</span>, <span class='va'>calc.v</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### add contrast matrix to dataset</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='contrmat.html'>contrmat</a></span><span class='op'>(</span><span class='va'>dat</span>, grp1<span class='op'>=</span><span class='st'>"treatment.1"</span>, grp2<span class='op'>=</span><span class='st'>"treatment.2"</span><span class='op'>)</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;                    study comment   treatment.1 ni.1  mi.1 sdi.1   treatment.2 
#&gt; 1            Alex (1998)  change     metformin  291  0.13 1.428  sulfonylurea 
#&gt; 2           Baksi (2004)  change rosiglitazone  218 -1.20 1.112       placebo 
#&gt; 3           Costa (1997)  change      acarbose   36 -1.10 0.360       placebo 
#&gt; 4        Davidson (2007)  change rosiglitazone  117 -1.20 1.097       placebo 
#&gt; 5       De Fronzo (1995)  change     metformin  213 -1.70 1.459       placebo 
#&gt; 6          Derosa (2004)     raw  pioglitazone   45  6.80 0.800 rosiglitazone 
#&gt; 7          Garber (2008)  change  vildagliptin  132 -0.63 1.034       placebo 
#&gt; 8  Gonzalez-Ortiz (2004)  change     metformin   34 -1.30 1.861       placebo 
#&gt; 9        Hanefeld (2004)     raw     metformin  320  7.45 1.073  pioglitazone 
#&gt; 10      Hermansen (2007)  change   sitagliptin  106 -0.30 0.940       placebo 
#&gt; 11       Johnston (1994)  change      miglitol   68 -0.41 1.072       placebo 
#&gt; 12      Johnston (1998a)  change      miglitol   91 -0.43 0.954       placebo 
#&gt; 13      Johnston (1998b)  change      miglitol   49 -0.12 1.400       placebo 
#&gt; 14        Kerenyi (2004)  change rosiglitazone  160 -0.91 0.990       placebo 
#&gt; 15            Kim (2007)  change     metformin   56 -1.10 1.139 rosiglitazone 
#&gt; 16         Kipnes (2001)  change  pioglitazone  182 -1.20 1.369       placebo 
#&gt; 17          Lewin (2007)  change     metformin  431 -0.74 1.106       placebo 
#&gt; 18         Moulin (2006)  change    benfluorex  161 -0.82 1.028       placebo 
#&gt; 19          Oyama (2008)  change      acarbose   41 -0.70 0.800  sulfonylurea 
#&gt; 20     Rosenstock (2008)  change rosiglitazone   59 -1.17 1.229       placebo 
#&gt; 21         Stucci (1996)     raw    benfluorex   28  8.03 1.290       placebo 
#&gt; 22 Vongthavaravat (2002)  change rosiglitazone  164 -1.10 1.559  sulfonylurea 
#&gt; 23         Willms (1999)  change      acarbose   31 -2.30 1.782       placebo 
#&gt; 24         Willms (1999)  change     metformin   29 -2.50 0.862       placebo 
#&gt; 25  Wolffenbuttel (1999)  change rosiglitazone  183 -0.90 1.100       placebo 
#&gt; 26           Yang (2003)  change     metformin   96 -0.95 1.500 rosiglitazone 
#&gt; 27            Zhu (2003)  change rosiglitazone  210 -1.90 1.470       placebo 
#&gt;    ni.2  mi.2 sdi.2 id  comp   design      yi     vi acarbose benfluorex 
#&gt; 1   300  0.50 1.450  1 me-su    me-su -0.3700 0.0140        0          0 
#&gt; 2   233  0.10 1.036  2 ro-pl    ro-pl -1.3000 0.0103        0          0 
#&gt; 3    29 -0.30 0.700  3 ac-pl    ac-pl -0.8000 0.0205        1          0 
#&gt; 4   116  0.14 1.093  4 ro-pl    ro-pl -1.3400 0.0206        0          0 
#&gt; 5   209  0.20 1.446  5 me-pl    me-pl -1.9000 0.0200        0          0 
#&gt; 6    42  6.70 0.900  6 pi-ro    pi-ro  0.1000 0.0335        0          0 
#&gt; 7   144  0.07 1.080  7 vi-pl    vi-pl -0.7000 0.0162        0          0 
#&gt; 8    37 -0.90 1.803  8 me-pl    me-pl -0.4000 0.1897        0          0 
#&gt; 9   319  7.61 1.072  9 me-pi    me-pi -0.1600 0.0072        0          0 
#&gt; 10  106  0.27 0.940 10 si-pl    si-pl -0.5700 0.0167        0          0 
#&gt; 11   63  0.33 1.032 11 mi-pl    mi-pl -0.7400 0.0338        0          0 
#&gt; 12   43  0.98 1.311 12 mi-pl    mi-pl -1.4100 0.0500        0          0 
#&gt; 13   34  0.56 1.166 13 mi-pl    mi-pl -0.6800 0.0800        0          0 
#&gt; 14  154 -0.14 0.920 14 ro-pl    ro-pl -0.7700 0.0116        0          0 
#&gt; 15   57 -1.10 1.341 15 me-ro    me-ro  0.0000 0.0547        0          0 
#&gt; 16  181  0.10 1.024 16 pi-pl    pi-pl -1.3000 0.0161        0          0 
#&gt; 17  144  0.08 1.004 17 me-pl    me-pl -0.8200 0.0098        0          0 
#&gt; 18  156  0.19 1.374 18 be-pl    be-pl -1.0100 0.0187        0          1 
#&gt; 19   43 -0.30 0.600 19 ac-su    ac-su -0.4000 0.0240        1          0 
#&gt; 20   57 -0.08 1.208 20 ro-pl    ro-pl -1.0900 0.0512        0          0 
#&gt; 21   30  8.26 1.350 21 be-pl    be-pl -0.2300 0.1202        0          1 
#&gt; 22  170  0.10 0.992 22 ro-su    ro-su -1.2000 0.0206        0          0 
#&gt; 23   29 -1.30 1.831 23 ac-pl ac-me-pl -1.0000 0.2180        1          0 
#&gt; 24   29 -1.30 1.831 24 me-pl ac-me-pl -1.2000 0.1412        0          0 
#&gt; 25  192  0.20 1.110 25 ro-pl    ro-pl -1.1000 0.0130        0          0 
#&gt; 26  102 -1.09 1.650 26 me-ro    me-ro  0.1400 0.0501        0          0 
#&gt; 27  105 -0.40 1.300 27 ro-pl    ro-pl -1.5000 0.0264        0          0 
#&gt;    metformin miglitol pioglitazone rosiglitazone sitagliptin sulfonylurea 
#&gt; 1          1        0            0             0           0           -1 
#&gt; 2          0        0            0             1           0            0 
#&gt; 3          0        0            0             0           0            0 
#&gt; 4          0        0            0             1           0            0 
#&gt; 5          1        0            0             0           0            0 
#&gt; 6          0        0            1            -1           0            0 
#&gt; 7          0        0            0             0           0            0 
#&gt; 8          1        0            0             0           0            0 
#&gt; 9          1        0           -1             0           0            0 
#&gt; 10         0        0            0             0           1            0 
#&gt; 11         0        1            0             0           0            0 
#&gt; 12         0        1            0             0           0            0 
#&gt; 13         0        1            0             0           0            0 
#&gt; 14         0        0            0             1           0            0 
#&gt; 15         1        0            0            -1           0            0 
#&gt; 16         0        0            1             0           0            0 
#&gt; 17         1        0            0             0           0            0 
#&gt; 18         0        0            0             0           0            0 
#&gt; 19         0        0            0             0           0           -1 
#&gt; 20         0        0            0             1           0            0 
#&gt; 21         0        0            0             0           0            0 
#&gt; 22         0        0            0             1           0           -1 
#&gt; 23         0        0            0             0           0            0 
#&gt; 24         1        0            0             0           0            0 
#&gt; 25         0        0            0             1           0            0 
#&gt; 26         1        0            0            -1           0            0 
#&gt; 27         0        0            0             1           0            0 
#&gt;    vildagliptin placebo 
#&gt; 1             0       0 
#&gt; 2             0      -1 
#&gt; 3             0      -1 
#&gt; 4             0      -1 
#&gt; 5             0      -1 
#&gt; 6             0       0 
#&gt; 7             1      -1 
#&gt; 8             0      -1 
#&gt; 9             0       0 
#&gt; 10            0      -1 
#&gt; 11            0      -1 
#&gt; 12            0      -1 
#&gt; 13            0      -1 
#&gt; 14            0      -1 
#&gt; 15            0       0 
#&gt; 16            0      -1 
#&gt; 17            0      -1 
#&gt; 18            0      -1 
#&gt; 19            0       0 
#&gt; 20            0      -1 
#&gt; 21            0      -1 
#&gt; 22            0       0 
#&gt; 23            0      -1 
#&gt; 24            0      -1 
#&gt; 25            0      -1 
#&gt; 26            0       0 
#&gt; 27            0      -1 </div><div class='input'>
<span class='co'>### network meta-analysis using a contrast-based random-effects model</span>
<span class='co'>### by setting rho=1/2, tau^2 reflects the amount of heterogeneity for all treatment comparisons</span>
<span class='co'>### the treatment left out (placebo) becomes the reference level for the treatment comparisons</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>V</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>acarbose</span> <span class='op'>+</span> <span class='va'>benfluorex</span> <span class='op'>+</span> <span class='va'>metformin</span> <span class='op'>+</span> <span class='va'>miglitol</span> <span class='op'>+</span> <span class='va'>pioglitazone</span> <span class='op'>+</span>
                              <span class='va'>rosiglitazone</span> <span class='op'>+</span> <span class='va'>sitagliptin</span> <span class='op'>+</span> <span class='va'>sulfonylurea</span> <span class='op'>+</span> <span class='va'>vildagliptin</span> <span class='op'>-</span> <span class='fl'>1</span>,
              random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>comp</span> <span class='op'>|</span> <span class='va'>study</span>, rho<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; 
#&gt; Multivariate Meta-Analysis Model (k = 27; method: REML)
#&gt; 
#&gt; Variance Components:
#&gt; 
#&gt; outer factor: study (nlvls = 26)
#&gt; inner factor: comp  (nlvls = 14)
#&gt; 
#&gt;             estim    sqrt  fixed 
#&gt; tau^2      0.0999  0.3161     no 
#&gt; rho        0.5000            yes 
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 18) = 96.9841, p-val &lt; .0001
#&gt; 
#&gt; Test of Moderators (coefficients 1:9):
#&gt; QM(df = 9) = 167.9616, p-val &lt; .0001
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;                estimate      se     zval    pval    ci.lb    ci.ub 
#&gt; acarbose        -0.8414  0.2384  -3.5288  0.0004  -1.3087  -0.3741  *** 
#&gt; benfluorex      -0.7369  0.2776  -2.6545  0.0079  -1.2810  -0.1928   ** 
#&gt; metformin       -1.1284  0.1494  -7.5528  &lt;.0001  -1.4212  -0.8356  *** 
#&gt; miglitol        -0.9499  0.2253  -4.2170  &lt;.0001  -1.3914  -0.5084  *** 
#&gt; pioglitazone    -1.1294  0.2119  -5.3295  &lt;.0001  -1.5448  -0.7141  *** 
#&gt; rosiglitazone   -1.2337  0.1235  -9.9933  &lt;.0001  -1.4757  -0.9918  *** 
#&gt; sitagliptin     -0.5700  0.3414  -1.6694  0.0950  -1.2392   0.0992    . 
#&gt; sulfonylurea    -0.4175  0.2326  -1.7950  0.0727  -0.8734   0.0384    . 
#&gt; vildagliptin    -0.7000  0.3408  -2.0543  0.0400  -1.3679  -0.0321    * 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'>### estimate all pairwise differences between treatments (using the 'multcomp' package)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='http://multcomp.R-forge.R-project.org'>multcomp</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='va'>contr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/multcomp/man/contrMat.html'>contrMat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='va'>res</span><span class='op'>$</span><span class='va'>p</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>X</span><span class='op'>)</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"Tukey"</span><span class='op'>)</span>
   <span class='va'>sav</span> <span class='op'>&lt;-</span> <span class='fu'><a href='predict.rma.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>, newmods<span class='op'>=</span><span class='va'>contr</span><span class='op'>)</span>
   <span class='va'>sav</span><span class='op'>[[</span><span class='st'>"slab"</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>contr</span><span class='op'>)</span>
   <span class='va'>sav</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: multcomp</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: mvtnorm</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: survival</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: TH.data</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: MASS</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘TH.data’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:MASS’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    geyser</span></div><div class='output co'>#&gt; 
#&gt;                                 pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
#&gt; benfluorex - acarbose         0.1045 0.3659 -0.6128 0.8217 -0.8433 1.0522 
#&gt; metformin - acarbose         -0.2870 0.2504 -0.7778 0.2037 -1.0774 0.5033 
#&gt; miglitol - acarbose          -0.1085 0.3280 -0.7514 0.5344 -1.0013 0.7843 
#&gt; pioglitazone - acarbose      -0.2880 0.3054 -0.8866 0.3105 -1.1495 0.5734 
#&gt; rosiglitazone - acarbose     -0.3924 0.2526 -0.8874 0.1026 -1.1854 0.4006 
#&gt; sitagliptin - acarbose        0.2714 0.4165 -0.5449 1.0876 -0.7534 1.2961 
#&gt; sulfonylurea - acarbose       0.4238 0.2568 -0.0796 0.9273 -0.3744 1.2221 
#&gt; vildagliptin - acarbose       0.1414 0.4159 -0.6738 0.9565 -0.8825 1.1652 
#&gt; metformin - benfluorex       -0.3915 0.3153 -1.0094 0.2264 -1.2665 0.4835 
#&gt; miglitol - benfluorex        -0.2130 0.3575 -0.9137 0.4877 -1.1483 0.7223 
#&gt; pioglitazone - benfluorex    -0.3925 0.3492 -1.0770 0.2920 -1.3157 0.5307 
#&gt; rosiglitazone - benfluorex   -0.4968 0.3038 -1.0923 0.0986 -1.3561 0.3625 
#&gt; sitagliptin - benfluorex      0.1669 0.4401 -0.6956 1.0294 -0.8950 1.2288 
#&gt; sulfonylurea - benfluorex     0.3194 0.3622 -0.3905 1.0292 -0.6228 1.2616 
#&gt; vildagliptin - benfluorex     0.0369 0.4395 -0.8245 0.8983 -1.0242 1.0980 
#&gt; miglitol - metformin          0.1785 0.2703 -0.3513 0.7083 -0.6366 0.9937 
#&gt; pioglitazone - metformin     -0.0010 0.2176 -0.4274 0.4254 -0.7531 0.7511 
#&gt; rosiglitazone - metformin    -0.1053 0.1600 -0.4189 0.2082 -0.7997 0.5890 
#&gt; sitagliptin - metformin       0.5584 0.3727 -0.1721 1.2889 -0.3994 1.5162 
#&gt; sulfonylurea - metformin      0.7109 0.2272  0.2656 1.1561 -0.0521 1.4738 
#&gt; vildagliptin - metformin      0.4284 0.3721 -0.3008 1.1576 -0.5285 1.3853 
#&gt; pioglitazone - miglitol      -0.1795 0.3093 -0.7857 0.4266 -1.0463 0.6872 
#&gt; rosiglitazone - miglitol     -0.2839 0.2569 -0.7873 0.2196 -1.0822 0.5144 
#&gt; sitagliptin - miglitol        0.3799 0.4091 -0.4218 1.1816 -0.6333 1.3931 
#&gt; sulfonylurea - miglitol       0.5324 0.3238 -0.1023 1.1670 -0.3545 1.4193 
#&gt; vildagliptin - miglitol       0.2499 0.4085 -0.5507 1.0505 -0.7624 1.2622 
#&gt; rosiglitazone - pioglitazone -0.1043 0.2163 -0.5283 0.3196 -0.8550 0.6464 
#&gt; sitagliptin - pioglitazone    0.5594 0.4019 -0.2282 1.3470 -0.4427 1.5615 
#&gt; sulfonylurea - pioglitazone   0.7119 0.2914  0.1407 1.2831 -0.1308 1.5545 
#&gt; vildagliptin - pioglitazone   0.4294 0.4013 -0.3571 1.2159 -0.5718 1.4306 
#&gt; sitagliptin - rosiglitazone   0.6637 0.3631 -0.0479 1.3754 -0.2798 1.6073 
#&gt; sulfonylurea - rosiglitazone  0.8162 0.2290  0.3674 1.2651  0.0512 1.5813 
#&gt; vildagliptin - rosiglitazone  0.5337 0.3624 -0.1766 1.2441 -0.4088 1.4763 
#&gt; sulfonylurea - sitagliptin    0.1525 0.4132 -0.6573 0.9622 -0.8671 1.1720 
#&gt; vildagliptin - sitagliptin   -0.1300 0.4824 -1.0755 0.8155 -1.2604 1.0004 
#&gt; vildagliptin - sulfonylurea  -0.2825 0.4126 -1.0911 0.5262 -1.3012 0.7362 
#&gt; </div><div class='input'>
<span class='co'>### fit random inconsistency effects model (see Law et al., 2016)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>V</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>acarbose</span> <span class='op'>+</span> <span class='va'>benfluorex</span> <span class='op'>+</span> <span class='va'>metformin</span> <span class='op'>+</span> <span class='va'>miglitol</span> <span class='op'>+</span> <span class='va'>pioglitazone</span> <span class='op'>+</span>
                              <span class='va'>rosiglitazone</span> <span class='op'>+</span> <span class='va'>sitagliptin</span> <span class='op'>+</span> <span class='va'>sulfonylurea</span> <span class='op'>+</span> <span class='va'>vildagliptin</span> <span class='op'>-</span> <span class='fl'>1</span>,
              random <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>comp</span> <span class='op'>|</span> <span class='va'>study</span>, <span class='op'>~</span> <span class='va'>comp</span> <span class='op'>|</span> <span class='va'>design</span><span class='op'>)</span>, rho<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, phi<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; 
#&gt; Multivariate Meta-Analysis Model (k = 27; method: REML)
#&gt; 
#&gt; Variance Components:
#&gt; 
#&gt; outer factor: study (nlvls = 26)
#&gt; inner factor: comp  (nlvls = 14)
#&gt; 
#&gt;             estim    sqrt  fixed 
#&gt; tau^2      0.0999  0.3161     no 
#&gt; rho        0.5000            yes 
#&gt; 
#&gt; outer factor: design (nlvls = 15)
#&gt; inner factor: comp   (nlvls = 14)
#&gt; 
#&gt;             estim    sqrt  fixed 
#&gt; gamma^2    0.0000  0.0000     no 
#&gt; phi        0.5000            yes 
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 18) = 96.9841, p-val &lt; .0001
#&gt; 
#&gt; Test of Moderators (coefficients 1:9):
#&gt; QM(df = 9) = 167.9616, p-val &lt; .0001
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;                estimate      se     zval    pval    ci.lb    ci.ub 
#&gt; acarbose        -0.8414  0.2384  -3.5288  0.0004  -1.3087  -0.3741  *** 
#&gt; benfluorex      -0.7369  0.2776  -2.6545  0.0079  -1.2810  -0.1928   ** 
#&gt; metformin       -1.1284  0.1494  -7.5528  &lt;.0001  -1.4212  -0.8356  *** 
#&gt; miglitol        -0.9499  0.2253  -4.2170  &lt;.0001  -1.3914  -0.5084  *** 
#&gt; pioglitazone    -1.1294  0.2119  -5.3295  &lt;.0001  -1.5448  -0.7141  *** 
#&gt; rosiglitazone   -1.2337  0.1235  -9.9933  &lt;.0001  -1.4757  -0.9918  *** 
#&gt; sitagliptin     -0.5700  0.3414  -1.6694  0.0950  -1.2392   0.0992    . 
#&gt; sulfonylurea    -0.4175  0.2326  -1.7950  0.0727  -0.8734   0.0384    . 
#&gt; vildagliptin    -0.7000  0.3408  -2.0543  0.0400  -1.3679  -0.0321    * 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


