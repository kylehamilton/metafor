<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Studies on Radiation Therapy with or without Adjuvant Chemotherapy in Patients with Malignant Gliomas — dat.fine1993 • metafor</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Studies on Radiation Therapy with or without Adjuvant Chemotherapy in Patients with Malignant Gliomas — dat.fine1993" />
<meta property="og:description" content="Results from 17 trials comparing post-operative radiation therapy with and without adjuvant chemotherapy in patients with malignant gliomas." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metafor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.5-52</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/metafor-package.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/pkgdown/diagram.html">Diagram</a>
</li>
<li>
  <a href="https://www.jstatsoft.org/index.php/jss/article/view/v036i03/v36i03.pdf">JSS Article (pdf)</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/wviechtb">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wviechtb/metafor">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Studies on Radiation Therapy with or without Adjuvant Chemotherapy in Patients with Malignant Gliomas</h1>
    
    <div class="hidden name"><code>dat.fine1993.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Results from 17 trials comparing post-operative radiation therapy with and without adjuvant chemotherapy in patients with malignant gliomas.</p>
    </div>

    <pre class="usage"><span class='va'>dat.fine1993</span></pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>The data frame contains the following columns:</p><table class='table'>
<tr><td><b>study</b></td><td><code>numeric</code></td><td>study number</td></tr>
<tr><td><b>nei</b></td><td><code>numeric</code></td><td>sample size in the experimental group receiving radiotherapy plus adjuvant chemotherapy</td></tr>
<tr><td><b>nci</b></td><td><code>numeric</code></td><td>sample size in the control group receiving radiotherapy alone</td></tr>
<tr><td><b>e1i</b></td><td><code>numeric</code></td><td>number of survivors at 6 months in the experimental group</td></tr>
<tr><td><b>c1i</b></td><td><code>numeric</code></td><td>number of survivors at 6 months in the control group</td></tr>
<tr><td><b>e2i</b></td><td><code>numeric</code></td><td>number of survivors at 12 months in the experimental group</td></tr>
<tr><td><b>c2i</b></td><td><code>numeric</code></td><td>number of survivors at 12 months in the control group</td></tr>
<tr><td><b>e3i</b></td><td><code>numeric</code></td><td>number of survivors at 18 months in the experimental group</td></tr>
<tr><td><b>c3i</b></td><td><code>numeric</code></td><td>number of survivors at 18 months in the control group</td></tr>
<tr><td><b>e4i</b></td><td><code>numeric</code></td><td>number of survivors at 24 months in the experimental group</td></tr>
<tr><td><b>c4i</b></td><td><code>numeric</code></td><td>number of survivors at 24 months in the control group</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The 17 trials report the post-operative survival of patients with malignant gliomas receiving either radiation therapy with adjuvant chemotherapy or radiation therapy alone. Survival was assessed at 6, 12, 18, and 24 months in all but one study (which assessed survival only at 12 and at 24 months).</p>
<p>The data were reconstructed by Trikalinos and Olkin (2012) based on Table 2 in Fine et al. (1993) and Table 3 in Dear (1994). The data can be used to illustrate how a meta-analysis can be conducted of effect sizes reported at multiple time points using a multivariate model.</p>
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Dear, K. B. G. (1994). Iterative generalized least squares for meta-analysis of survival data at multiple times. <em>Biometrics</em>, <b>50</b>(4), 989--1002. <a href='https://doi.org/10.2307/2533438'>https://doi.org/10.2307/2533438</a></p>
<p>Trikalinos, T. A., &amp; Olkin, I. (2012). Meta-analysis of effect sizes reported at multiple time points: A multivariate approach. <em>Clinical Trials</em>, <b>9</b>(5), 610--620. <a href='https://doi.org/10.1177/1740774512453218'>https://doi.org/10.1177/1740774512453218</a></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fine, H. A., Dear, K. B., Loeffler, J. S., Black, P. M., &amp; Canellos, G. P. (1993). Meta-analysis of radiation therapy with and without adjuvant chemotherapy for malignant gliomas in adults. <em>Cancer</em>, <b>71</b>(8), 2585--2597. <a href='https://doi.org/10.1002/1097-0142(19930415)71:8&lt;2585::aid-cncr2820710825&gt;3.0.co;2-s'>https://doi.org/10.1002/1097-0142(19930415)71:8&lt;2585::aid-cncr2820710825&gt;3.0.co;2-s</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### copy data into 'dat' and examine data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat.fine1993</span>
<span class='va'>dat</span>
</div><div class='output co'>#&gt;    study nei nci e1i c1i e2i c2i e3i c3i e4i c4i
#&gt; 1      1  19  22  16  20  11  12   4   8   4   3
#&gt; 2      2  34  35  22  22  18  12  15   8  15   6
#&gt; 3      3  72  68  44  40  21  15  10   3   3   0
#&gt; 4      4  22  20  19  12  14   5   5   4   2   3
#&gt; 5      5  70  32  62  27  42  13  26   6  15   5
#&gt; 6      6 183  94 130  65  80  33  47  14  30  11
#&gt; 7      7  26  50  24  30  13  18   5  10   3   9
#&gt; 8      8  61  55  51  44  37  30  19  19  11  15
#&gt; 9      9  36  25  30  17  23  12  13   4  10   4
#&gt; 10    10  45  35  43  35  19  14   8   4   6   0
#&gt; 11    11 246 208 169 139 106  76  67  42  51  35
#&gt; 12    12 386 141 279  97 170  46  97  21  73   8
#&gt; 13    13  59  32  56  30  34  17  21   9  20   7
#&gt; 14    14  45  15  42  10  18   3   9   1   9   1
#&gt; 15    15  14  18  14  18  13  14  12  13   9  12
#&gt; 16    16  26  19  21  15  12  10   6   4   5   1
#&gt; 17    17  74  75  NA  NA  42  40  NA  NA  23  30</div><div class='input'>
<span class='co'>### calculate log(ORs) and sampling variances for each time point</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"OR"</span>, ai<span class='op'>=</span><span class='va'>e1i</span>, n1i<span class='op'>=</span><span class='va'>nei</span>, ci<span class='op'>=</span><span class='va'>c1i</span>, n2i<span class='op'>=</span><span class='va'>nci</span>, data<span class='op'>=</span><span class='va'>dat</span>, var.names<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1i"</span>,<span class='st'>"v1i"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"OR"</span>, ai<span class='op'>=</span><span class='va'>e2i</span>, n1i<span class='op'>=</span><span class='va'>nei</span>, ci<span class='op'>=</span><span class='va'>c2i</span>, n2i<span class='op'>=</span><span class='va'>nci</span>, data<span class='op'>=</span><span class='va'>dat</span>, var.names<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y2i"</span>,<span class='st'>"v2i"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"OR"</span>, ai<span class='op'>=</span><span class='va'>e3i</span>, n1i<span class='op'>=</span><span class='va'>nei</span>, ci<span class='op'>=</span><span class='va'>c3i</span>, n2i<span class='op'>=</span><span class='va'>nci</span>, data<span class='op'>=</span><span class='va'>dat</span>, var.names<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y3i"</span>,<span class='st'>"v3i"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='escalc.html'>escalc</a></span><span class='op'>(</span>measure<span class='op'>=</span><span class='st'>"OR"</span>, ai<span class='op'>=</span><span class='va'>e4i</span>, n1i<span class='op'>=</span><span class='va'>nei</span>, ci<span class='op'>=</span><span class='va'>c4i</span>, n2i<span class='op'>=</span><span class='va'>nci</span>, data<span class='op'>=</span><span class='va'>dat</span>, var.names<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y4i"</span>,<span class='st'>"v4i"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### calculate the covariances (equations in Appendix of Trikalinos &amp; Olkin, 2012)</span>
<span class='va'>dat</span><span class='op'>$</span><span class='va'>v12i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>nei</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>e1i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nei</span> <span class='op'>-</span> <span class='va'>e2i</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>nci</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>c1i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nci</span> <span class='op'>-</span> <span class='va'>c2i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>$</span><span class='va'>v13i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>nei</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>e1i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nei</span> <span class='op'>-</span> <span class='va'>e3i</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>nci</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>c1i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nci</span> <span class='op'>-</span> <span class='va'>c3i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>$</span><span class='va'>v14i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>nei</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>e1i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nei</span> <span class='op'>-</span> <span class='va'>e4i</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>nci</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>c1i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nci</span> <span class='op'>-</span> <span class='va'>c4i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>$</span><span class='va'>v23i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>nei</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>e2i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nei</span> <span class='op'>-</span> <span class='va'>e3i</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>nci</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>c2i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nci</span> <span class='op'>-</span> <span class='va'>c3i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>$</span><span class='va'>v24i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>nei</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>e2i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nei</span> <span class='op'>-</span> <span class='va'>e4i</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>nci</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>c2i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nci</span> <span class='op'>-</span> <span class='va'>c4i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>$</span><span class='va'>v34i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>nei</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>e3i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nei</span> <span class='op'>-</span> <span class='va'>e4i</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>nci</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>c3i</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>nci</span> <span class='op'>-</span> <span class='va'>c4i</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### create dataset in long format</span>
<span class='va'>dat.long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>study<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>, each<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>, time<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>,
                       yi<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y1i"</span>,<span class='st'>"y2i"</span>,<span class='st'>"y3i"</span>,<span class='st'>"y4i"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>,
                       vi<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"v1i"</span>,<span class='st'>"v2i"</span>,<span class='st'>"v3i"</span>,<span class='st'>"v4i"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### var-cov matrices of the sudies</span>
<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>study</span><span class='op'>)</span>,
            <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>v1i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v12i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v13i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v14i</span>,
                                 <span class='va'>x</span><span class='op'>$</span><span class='va'>v12i</span>,  <span class='va'>x</span><span class='op'>$</span><span class='va'>v2i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v23i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v24i</span>,
                                 <span class='va'>x</span><span class='op'>$</span><span class='va'>v13i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v23i</span>,  <span class='va'>x</span><span class='op'>$</span><span class='va'>v3i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v34i</span>,
                                 <span class='va'>x</span><span class='op'>$</span><span class='va'>v14i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v24i</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>v34i</span>,  <span class='va'>x</span><span class='op'>$</span><span class='va'>v4i</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='fl'>4</span>, ncol<span class='op'>=</span><span class='fl'>4</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### remove rows for the missing time points in study 17</span>
<span class='va'>dat.long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>dat.long</span><span class='op'>)</span>

<span class='co'>### remove corresponding rows/columns from var-cov matrix</span>
<span class='va'>V</span><span class='op'>[[</span><span class='fl'>17</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>V</span><span class='op'>[[</span><span class='fl'>17</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'>### make a copy of V</span>
<span class='va'>Vc</span> <span class='op'>&lt;-</span> <span class='va'>V</span>

<span class='co'>### replace any (near) singular var-cov matrices with ridge corrected versions</span>
<span class='va'>repl.Vi</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>Vi</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>Vi</span><span class='op'>)</span>
   <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>values</span> <span class='op'>&lt;=</span> <span class='fl'>.08</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>vectors</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>values</span> <span class='op'>+</span> <span class='fl'>.08</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>)</span>, <span class='fl'>12</span><span class='op'>)</span>
   <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
      <span class='va'>Vi</span>
   <span class='op'>}</span>
<span class='op'>}</span>
<span class='va'>Vc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>Vc</span>, <span class='va'>repl.Vi</span><span class='op'>)</span>

<span class='co'>### do not correct var-cov matrix of study 17</span>
<span class='va'>Vc</span><span class='op'>[[</span><span class='fl'>17</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>V</span><span class='op'>[[</span><span class='fl'>17</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'>### construct block diagonal matrix</span>
<span class='va'>Vc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bldiag.html'>bldiag</a></span><span class='op'>(</span><span class='va'>Vc</span><span class='op'>)</span>

<span class='co'>### multivariate fixed-effects model</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>Vc</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span>, method<span class='op'>=</span><span class='st'>"FE"</span>, data<span class='op'>=</span><span class='va'>dat.long</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>res</span>, digits<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Multivariate Meta-Analysis Model (k = 66; method: FE)
#&gt; 
#&gt; Variance Components: none
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 62) = 62.447, p-val = 0.460
#&gt; 
#&gt; Test of Moderators (coefficients 1:4):
#&gt; QM(df = 4) = 15.631, p-val = 0.004
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;                estimate     se   zval   pval   ci.lb  ci.ub 
#&gt; factor(time)1     0.251  0.143  1.755  0.079  -0.029  0.532    . 
#&gt; factor(time)2     0.428  0.114  3.742  &lt;.001   0.204  0.652  *** 
#&gt; factor(time)3     0.343  0.134  2.560  0.010   0.080  0.606    * 
#&gt; factor(time)4     0.281  0.138  2.035  0.042   0.010  0.552    * 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'>### multivariate random-effects model with heteroscedastic AR(1) structure for the true effects</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yi</span>, <span class='va'>Vc</span>, mods <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span>, random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>time</span> <span class='op'>|</span> <span class='va'>study</span>,
              struct<span class='op'>=</span><span class='st'>"HAR"</span>, data<span class='op'>=</span><span class='va'>dat.long</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>res</span>, digits<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Multivariate Meta-Analysis Model (k = 66; method: REML)
#&gt; 
#&gt; Variance Components:
#&gt; 
#&gt; outer factor: study (nlvls = 17)
#&gt; inner factor: time  (nlvls = 4)
#&gt; 
#&gt;            estim   sqrt  k.lvl  fixed  level 
#&gt; tau^2.1    0.000  0.000     16     no      1 
#&gt; tau^2.2    0.000  0.000     17     no      2 
#&gt; tau^2.3    0.028  0.166     16     no      3 
#&gt; tau^2.4    0.194  0.441     17     no      4 
#&gt; rho        1.000                   no        
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 62) = 62.447, p-val = 0.460
#&gt; 
#&gt; Test of Moderators (coefficients 1:4):
#&gt; QM(df = 4) = 14.695, p-val = 0.005
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;                estimate     se   zval   pval   ci.lb  ci.ub 
#&gt; factor(time)1     0.253  0.143  1.769  0.077  -0.027  0.534    . 
#&gt; factor(time)2     0.408  0.115  3.539  &lt;.001   0.182  0.634  *** 
#&gt; factor(time)3     0.366  0.144  2.532  0.011   0.083  0.649    * 
#&gt; factor(time)4     0.352  0.187  1.886  0.059  -0.014  0.718    . 
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># \dontrun{</span>
<span class='co'>### profile the variance components</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>res</span>, tau2<span class='op'>=</span><span class='fl'>1</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='fl'>0</span>,<span class='fl'>.2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: At least one profiled log-likelihood value is larger than the log-likelihood of the fitted model.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>res</span>, tau2<span class='op'>=</span><span class='fl'>2</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='fl'>0</span>,<span class='fl'>.2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>res</span>, tau2<span class='op'>=</span><span class='fl'>3</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='fl'>0</span>,<span class='fl'>.2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>res</span>, tau2<span class='op'>=</span><span class='fl'>4</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span><span class='co'># }</span>
</div><div class='img'><img src='dat.fine1993-1.png' alt='' width='768' height='614' /></div><div class='input'>
<span class='co'># \dontrun{</span>
<span class='co'>### profile the autocorrelation coefficient</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>res</span>, rho<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='co'># }</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: At least one profiled log-likelihood value is larger than the log-likelihood of the fitted model.</span></div><div class='img'><img src='dat.fine1993-2.png' alt='' width='768' height='614' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


